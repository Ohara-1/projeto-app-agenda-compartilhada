{% extends "layout/app_layout.html" %}

{% block title %}Calendário - Agenda Familiar{% endblock %}

{% block content %}
{% if no_family %}
    <div class="form-container" style="text-align: center;">
        <h2 class="empty-state-title">Você ainda não participa de nenhum calendário</h2>
        <p class="form-info">Entre em um grupo para começar a usar a Agenda Familiar!</p>
        <div class="form-actions">
            <a href="{{ url_for('main.create_family') }}" class="btn btn-primary">Criar grupo</a>
            <a href="{{ url_for('main.join_family_page') }}" class="btn btn-secondary">Entrar em grupo</a>
        </div>
    </div>
{% else %}
    <div class="calendar-container">
        <div class="calendar-header">
            <div class="month-title">
                {% set months = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'] %}
                {{ months[current_month - 1] }} {{ current_year }}
            </div>
            <div class="calendar-nav">
                <button class="calendar-nav-btn" onclick="location.href='?month={{ current_month - 1 if current_month > 1 else 12 }}&year={{ current_year if current_month > 1 else current_year - 1 }}'">
                    &lt;
                </button>
                <button class="calendar-nav-btn today" onclick="location.href='?'">
                    Hoje
                </button>
                <button class="calendar-nav-btn" onclick="location.href='?month={{ current_month + 1 if current_month < 12 else 1 }}&year={{ current_year if current_month < 12 else current_year + 1 }}'">
                    &gt;
                </button>
            </div>
        </div>
        
        <div class="calendar-grid">
            <!-- Cabeçalhos de dia -->
            <div class="calendar-day-header">Dom</div>
            <div class="calendar-day-header">Seg</div>
            <div class="calendar-day-header">Ter</div>
            <div class="calendar-day-header">Qua</div>
            <div class="calendar-day-header">Qui</div>
            <div class="calendar-day-header">Sex</div>
            <div class="calendar-day-header">Sáb</div>
            
            <!-- Dias vazios antes do início do mês -->
            {% for i in range(first_day_of_month) %}
                <div class="calendar-day"></div>
            {% endfor %}
            
            <!-- Dias do mês -->
            {% for day in range(1, days_in_month + 1) %}
                <div class="calendar-day {% if today and day == today.day and current_month == today.month and current_year == today.year %}today{% endif %}">
                    {{ day }}
                    
                    <!-- Eventos do dia -->
                    {% for event in events %}
                        {% if event.start_time.day == day and event.start_time.month == current_month and event.start_time.year == current_year %}
                            <div class="calendar-event" onclick="location.href='{{ url_for('main.edit_event', event_id=event.id) }}'">
                                {{ event.title }}
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
    </div>
    
    <!-- Tarefas pendentes -->
    <div class="tasks-panel">
        <h3 class="tasks-title">Tarefas Pendentes</h3>
        {% if upcoming_events %}
            <ul style="list-style: none; padding: 0;">
                {% for event in upcoming_events %}
                    <li class="task-item">
                        <span>{{ event.title }}</span>
                        <span style="margin-left: auto; color: #666; font-size: 0.9rem;">{{ event.start_time.strftime('%d/%m/%Y %H:%M') }}</span>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p style="color: #666; text-align: center;">Nenhuma tarefa pendente.</p>
        {% endif %}
    </div>
{% endif %}
{% endblock %} 
